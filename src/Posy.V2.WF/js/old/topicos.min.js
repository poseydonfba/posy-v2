$(document).ready(function(){var b;a();$(document).on("click",".ed-cnt-cmt .btnAddPost",function(){e($(this).closest(".ed-cnt-cmt"))});$(document).on("click",".btnMenuItem",function(){if($(this).attr("opcao")=="E"){d($(this))}else{if($(this).attr("opcao")=="M"){c($(this))}}});function d(h){var g=$(".tooltip-dropmenu-container[codpost="+h.attr("codpost")+"]");g.buttonLoader("start");var i=new Object();i.CodPost=h.attr("codpost");var f={objeto:i};perfil.metodo="ExcluirTopicoPost";perfil.data=JSON.stringify(f);perfil.ajaxWs(function(j){g.buttonLoader("stop");$(".list-li[codpost="+h.attr("codpost")+"]").fadeOut(300,function(){$(this).remove()})})}function c(h){var g=$(".tooltip-dropmenu-container[codpost="+h.attr("codpost")+"]");g.buttonLoader("start");var i=new Object();i.CodCmm=h.attr("cc");i.CodPerfilModerador=h.attr("cp");var f={objeto:i};perfil.metodo="AddCmmModerador";perfil.data=JSON.stringify(f);perfil.ajaxWs(function(k){g.buttonLoader("stop");var j="<span class='cmm-mode'>MODERADOR DA COMUNIDADE</span>";$(j).insertAfter(".list-li[cp="+h.attr("cp")+"] .list-h3");$(".menuitem[cp="+h.attr("cp")+"]").closest("a").remove();fnIniTooltipSubMenu();fnNotificacao("success","Sucesso na operação.",V_TIME_MESSAGE)})}function e(g){var j;var h=g.find(".the-new-com"),f=h.get(0).nodeName;if(f=="IFRAME"){j=h.contents().find("body").html()}else{j=h.val()}if(j==""){fnNotificacao("warning","Nenhum texto para o post.",V_TIME_MESSAGE);return false}var k=g.find(".btnAddPost");k.buttonLoader("start");var l=new Object();l.Descricao=j;var i={objeto:l};perfil.metodo="SalvarTopicoPost";perfil.data=JSON.stringify(i);perfil.ajaxWs(function(o){k.buttonLoader("stop");$(".poseydon-cmm-post-list-size ul").append(o.d);$(".poseydon-cmm-post-list-size ul li.postado-recente").fadeIn("slow");fnOcultarContainerEditor(g);var m=$(".ms-tit-blc-btn"),n=(m.text()===undefined||m.text()=="")?0:parseInt(m.text());m.text((n+1));setTimeout(function(){$(".postado-recente").removeClass("postado-recente")},500);fnIniTooltipSubMenu()})}function a(){var f=$(".mv-loading").boxLoader();fnLimparViewCmm();perfil.metodo="getCmmForumTopicoView";perfil.ajaxWs(function(m){f.stop();var l=m.d,h=l[0],i=l[1],k=l[2],j=l[3],g=l[4];fnShowViewCmm(h,i,k,g);$(".view-topico").html(g[3]).hide().fadeIn("slow");if(g[1]!=""){$(".view-editor").html(g[4]);b=$(".ed-cnt-cmt").editorHtml({autoHeight:false});$(".cmt-cnt-editor").show()}fnInicializaViewCmm()})}});
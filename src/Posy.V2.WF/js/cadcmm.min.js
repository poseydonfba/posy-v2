$(document).ready(function(){var a,f,e,d;a=$("#txtNome");f=$("#dropCategoria");e=$("#dropTipo");d=$(".ed-cnt-cmt").editorHtml({buttonsBottom:false});b();$(document).on("click",".btnCriarComunidade",function(){if(fnVerificaCampos("#formDados")!="n"){fnNotificacao("warning","Preencha os campos corretamente.",V_TIME_MESSAGE);$("html, body").animate({scrollTop:0},"slow");return false}h($(this))});$(document).on("click",".btnExcluirCmm",function(){if(confirm("Confirma a exclusão da comunidade?")==false){return false}g($(this))});$(document).on("keyup","#txtNome",function(){$(".lblNome").text($(this).val())});$(document).on("click",".btnSalvarDadosPrivacidade",function(){c($(this))});function h(m){var l=m;l.buttonLoader("start");var n=new Object();n.CodCmm=codCmm;n.Nome=a.val();n.CodCategoria=f.val();var j=d.find(".the-new-com"),i=j.get(0).nodeName;if(i=="IFRAME"){n.PerfilHtml=j.contents().find("body").html()}else{n.PerfilHtml=j.val()}var o=($("#containerCropImg .resize-image").attr("base64String")===undefined)?"":$("#containerCropImg .resize-image").attr("base64String");var k={objeto:n,base64String:o};perfil.metodo="CriarCmm";perfil.data=JSON.stringify(k);perfil.ajaxWs(function(p){l.buttonLoader("stop");fnNotificacao("success","Comunidade criada com sucesso.",V_TIME_MESSAGE);$("label[idcontent='content-2']").closest("td").show();$("label[idcontent='content-3']").closest("td").show();fnLocationHref(p.d)})}function c(k){var j=k;j.buttonLoader("start");var l=new Object();l.CodCmm=codCmm;l.Tipo=e.val();var i={objeto:l};perfil.metodo="SalvarPrivacidadeCmm";perfil.data=JSON.stringify(i);perfil.ajaxWs(function(m){j.buttonLoader("stop");fnNotificacao("success","Sucesso na operação.",V_TIME_MESSAGE);$("html, body").animate({scrollTop:0},"slow")})}function g(k){var j=k;j.buttonLoader("start");var l=new Object();l.CodCmm=codCmm;var i={objeto:l};perfil.metodo="ExcluirCmm";perfil.data=JSON.stringify(i);perfil.ajaxWs(function(m){j.buttonLoader("stop");fnNotificacao("success","Comunidade excluída com sucesso.",V_TIME_MESSAGE);fnLocationHref(m.d)})}function b(){fnLimparViewCmm();$(".lblNome").html("Nome da Comunidade");$(".ms-tit-blc-txt").html("Criar Comunidade");$(".btnCriarComunidade").show();$(".btnSalvarDadosCmm").hide();$(".btnExcluirCmm").hide();d.find(".new-com-bt").click();a.focus();$("html, body").animate({scrollTop:0},"slow")}});